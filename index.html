<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simulator - Enhanced</title>
    <meta name="description" content="A comprehensive test-taking application with timer, progress saving, and accessibility features">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#21808D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Test Simulator">
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Theme Toggle Button -->
    <button id="theme-toggle" class="theme-toggle-btn" aria-label="Open theme menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="13.5" cy="6.5" r=".5"></circle>
            <circle cx="17.5" cy="10.5" r=".5"></circle>
            <circle cx="8.5" cy="7.5" r=".5"></circle>
            <circle cx="6.5" cy="12.5" r=".5"></circle>
            <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"></path>
        </svg>
    </button>

    <!-- Theme Menu -->
    <div id="theme-menu" class="theme-menu hidden" role="menu" aria-label="Theme selection">
        <div class="theme-menu-header">Choose Theme</div>
        <button class="theme-option" data-theme="light" role="menuitem">
            <span class="theme-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </span>
            <span>Perplexity Light</span>
        </button>
        <button class="theme-option" data-theme="dark" role="menuitem">
            <span class="theme-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </span>
            <span>Perplexity Dark</span>
        </button>
        <button class="theme-option" data-theme="claude-light" role="menuitem">
            <span class="theme-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="6"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                </svg>
            </span>
            <span>Claude Light</span>
        </button>
        <button class="theme-option" data-theme="claude-dark" role="menuitem">
            <span class="theme-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="4"></circle>
                </svg>
            </span>
            <span>Claude Dark</span>
        </button>
    </div>

    <!-- Auth Header -->
    <div id="auth-header" class="auth-header">
        <div class="auth-container">
            <!-- Not signed in state -->
            <div id="auth-signed-out" class="auth-state">
                <div class="auth-message">
                    <span class="auth-icon">‚òÅÔ∏è</span>
                    <span>Sign in to sync your tests across devices</span>
                </div>
                <button id="sign-in-btn" class="btn btn--primary btn--sm">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                    </svg>
                    Sign in with Google
                </button>
            </div>

            <!-- Signed in state -->
            <div id="auth-signed-in" class="auth-state hidden">
                <div class="auth-user-info">
                    <img id="auth-user-photo" class="auth-user-photo" src="" alt="User photo">
                    <div class="auth-user-details">
                        <span id="auth-user-name" class="auth-user-name"></span>
                        <div class="auth-sync-status">
                            <span id="sync-indicator" class="sync-indicator" title="Synced">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                                Synced
                            </span>
                        </div>
                    </div>
                </div>
                <button id="sign-out-btn" class="btn btn--outline btn--sm">Sign out</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Landing Section -->
        <div id="landing-section" class="section landing-section">
            <div class="landing-content">
                <div class="landing-decorative-top">
                    <svg class="decorative-branch" viewBox="0 0 200 100" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10,50 Q30,30 50,50 T90,50" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="25" cy="38" r="3" fill="currentColor" opacity="0.6"/>
                        <circle cx="45" cy="62" r="2.5" fill="currentColor" opacity="0.5"/>
                        <circle cx="70" cy="38" r="3.5" fill="currentColor" opacity="0.6"/>
                    </svg>
                </div>

                <div class="landing-hero">
                    <h1 class="landing-title">Welcome to Your Study Space</h1>
                    <p class="landing-subtitle">A gentle place to practice, learn, and grow</p>
                </div>

                <div class="landing-features">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                <path d="M2 17l10 5 10-5"/>
                                <path d="M2 12l10 5 10-5"/>
                            </svg>
                        </div>
                        <h3>Practice at Your Pace</h3>
                        <p>Take your time with custom tests designed to support your learning journey</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <h3>Your Personal Library</h3>
                        <p>Save and organize your tests in one cozy place, accessible anytime</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </div>
                        <h3>Mindful Focus Timer</h3>
                        <p>Study sessions paired with gentle breaks to keep you refreshed</p>
                    </div>
                </div>

                <div class="landing-cta">
                    <button id="get-started-btn" class="btn btn--primary btn--large landing-btn">Start Learning</button>
                    <p class="landing-hint">No account needed to start. Sign in anytime to save your progress.</p>
                </div>

                <div class="landing-decorative-bottom">
                    <svg class="decorative-dots" viewBox="0 0 100 20" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="10" cy="10" r="2" fill="currentColor" opacity="0.3"/>
                        <circle cx="30" cy="10" r="2" fill="currentColor" opacity="0.4"/>
                        <circle cx="50" cy="10" r="2" fill="currentColor" opacity="0.5"/>
                        <circle cx="70" cy="10" r="2" fill="currentColor" opacity="0.4"/>
                        <circle cx="90" cy="10" r="2" fill="currentColor" opacity="0.3"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- JSON Input Section -->
        <div id="json-input-section" class="section hidden">
            <div class="card">
                <div class="card__body">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-12);">
                        <div>
                            <h1 style="margin-bottom: var(--space-8);">Test Simulator</h1>
                            <p class="text-secondary">Paste your test JSON data below to load a test</p>
                        </div>
                        <button id="back-to-landing-btn" class="btn btn--outline btn--sm" style="flex-shrink: 0;">Back to Welcome</button>
                    </div>

                    <!-- Test Mode Selection -->
                    <div class="test-mode-container">
                        <div class="form-group">
                            <label class="form-label">Test Mode</label>
                            <div class="mode-selector">
                                <label class="mode-option">
                                    <input type="radio" name="test-mode" value="exam" id="mode-exam" checked>
                                    <div class="mode-card">
                                        <div class="mode-icon">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                                <polyline points="14 2 14 8 20 8"></polyline>
                                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                                <polyline points="10 9 9 9 8 9"></polyline>
                                            </svg>
                                        </div>
                                        <div class="mode-title">Exam Mode</div>
                                        <div class="mode-description">Timed test with final scoring. Traditional exam experience.</div>
                                    </div>
                                </label>
                                <label class="mode-option">
                                    <input type="radio" name="test-mode" value="practice" id="mode-practice">
                                    <div class="mode-card">
                                        <div class="mode-icon">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                                            </svg>
                                        </div>
                                        <div class="mode-title">Practice Mode</div>
                                        <div class="mode-description">Instant feedback with correct answers shown. Learn as you go!</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Timer Settings -->
                    <div class="timer-settings-container">
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="timer-toggle">
                                <span>Enable timer</span>
                            </label>
                        </div>
                        <div id="timer-settings" class="hidden">
                            <div class="form-group">
                                <label for="timer-duration" class="form-label">Duration (minutes)</label>
                                <input
                                    type="number"
                                    id="timer-duration"
                                    class="form-control"
                                    value="30"
                                    min="1"
                                    max="180"
                                    aria-label="Test duration in minutes"
                                >
                            </div>
                        </div>
                    </div>

                    <!-- Shuffle Settings -->
                    <div class="shuffle-settings-container">
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="shuffle-toggle">
                                <span>üîÄ Smart Shuffle</span>
                            </label>
                        </div>
                        <div id="shuffle-settings" class="hidden">
                            <div class="form-group">
                                <label for="shuffle-mode" class="form-label">Shuffle Mode</label>
                                <select id="shuffle-mode" class="form-control" aria-label="Select shuffle mode">
                                    <option value="both">Shuffle Questions & Options</option>
                                    <option value="questions">Shuffle Questions Only</option>
                                    <option value="options">Shuffle Options Only</option>
                                    <option value="smart">Smart Shuffle (maintain difficulty curve)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="shuffle-seed">
                                    <span>Use reproducible shuffle (same order each time)</span>
                                </label>
                            </div>
                            <div id="shuffle-seed-input" class="form-group hidden">
                                <label for="shuffle-seed-value" class="form-label">Shuffle Seed (optional)</label>
                                <input
                                    type="number"
                                    id="shuffle-seed-value"
                                    class="form-control"
                                    placeholder="Leave empty for random seed"
                                    aria-label="Shuffle seed value"
                                >
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="json-input" class="form-label">Test JSON Data</label>
                        <textarea
                            id="json-input"
                            class="form-control"
                            rows="10"
                            aria-label="Test JSON data input"
                            placeholder='Paste your test JSON here...

Example format:
{
  "title": "Sample Test",
  "questions": [
    {
      "id": 1,
      "type": "mcq",
      "question": "Question text",
      "options": ["A", "B", "C", "D"],
      "correct": 1
    }
  ]
}'></textarea>
                    </div>

                    <div id="error-message" class="error-message hidden" aria-live="assertive"></div>

                    <div class="button-group">
                        <button id="load-test-btn" class="btn btn--primary">Load Test</button>
                        <button id="load-sample-btn" class="btn btn--outline">Load Sample Test</button>
                    </div>

                    <div class="button-group" style="margin-top: var(--space-12);">
                        <button id="open-test-builder-btn" class="btn btn--primary">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Build a Test
                        </button>
                        <button id="open-library-btn" class="btn btn--secondary">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                            My Saved Tests
                        </button>
                        <button id="open-pomodoro-btn" class="btn btn--secondary">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            Focus Timer
                        </button>
                    </div>
                    <div class="button-group" style="margin-top: var(--space-12);">
                        <button id="open-analytics-btn" class="btn btn--secondary">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 20V10"></path>
                                <path d="M12 20V4"></path>
                                <path d="M6 20v-6"></path>
                            </svg>
                            Analytics Dashboard
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Dashboard Section -->
        <div id="analytics-section" class="section hidden">
            <div class="library-header">
                <h1>Analytics Dashboard</h1>
                <button id="close-analytics-btn" class="btn btn--outline">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Back
                </button>
            </div>

            <div class="analytics-container">
                <!-- Level and XP Progress Section -->
                <div class="analytics-section analytics-hero">
                    <div class="level-badge">
                        <div class="level-badge-inner">
                            <div class="level-badge-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"></path>
                                </svg>
                            </div>
                            <div class="level-badge-text">
                                <div class="level-label">Level</div>
                                <div id="analytics-level" class="level-number">1</div>
                            </div>
                        </div>
                    </div>
                    <div class="xp-progress-container">
                        <div class="xp-progress-header">
                            <span class="xp-label">Experience Points</span>
                            <span id="analytics-xp-text" class="xp-value">0 / 100 XP</span>
                        </div>
                        <div class="xp-progress-bar">
                            <div id="analytics-xp-fill" class="xp-progress-fill" style="width: 0%"></div>
                        </div>
                        <div class="xp-progress-footer">
                            <span id="analytics-xp-percent" class="xp-percent">0% to next level</span>
                        </div>
                    </div>
                </div>

                <!-- Stats Overview Cards -->
                <div class="analytics-section">
                    <h2 class="analytics-heading">Statistics Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon stat-icon--primary">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Tests Completed</div>
                                <div id="stat-tests-completed" class="stat-value">0</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon stat-icon--success">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Overall Accuracy</div>
                                <div id="stat-accuracy" class="stat-value">0%</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon stat-icon--warning">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12 6 12 12 16 14"></polyline>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Total Study Time</div>
                                <div id="stat-study-time" class="stat-value">0h</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon stat-icon--fire">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                    <path d="M8.5 8.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S7 6.17 7 7s.67 1.5 1.5 1.5z"></path>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Current Streak</div>
                                <div id="stat-streak" class="stat-value">0 days</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon stat-icon--gold">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="8" r="7"></circle>
                                    <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Perfect Scores</div>
                                <div id="stat-perfect-scores" class="stat-value">0</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon stat-icon--purple">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"></path>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Achievements</div>
                                <div id="stat-achievements" class="stat-value">0 / 20</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Achievement Gallery -->
                <div class="analytics-section">
                    <h2 class="analytics-heading">Achievement Gallery</h2>
                    <div class="achievement-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="unlocked">Unlocked</button>
                        <button class="filter-btn" data-filter="locked">Locked</button>
                    </div>
                    <div id="achievement-gallery" class="achievement-gallery">
                        <!-- Achievement cards will be inserted here -->
                    </div>
                </div>

                <!-- Question Type Breakdown -->
                <div class="analytics-section">
                    <h2 class="analytics-heading">Question Type Breakdown</h2>
                    <div id="question-type-chart" class="question-type-chart">
                        <!-- Chart will be inserted here -->
                    </div>
                </div>

                <!-- Additional Stats -->
                <div class="analytics-section">
                    <h2 class="analytics-heading">Detailed Statistics</h2>
                    <div class="detailed-stats">
                        <div class="detailed-stat-row">
                            <span class="detailed-stat-label">Total Questions Answered</span>
                            <span id="stat-total-questions" class="detailed-stat-value">0</span>
                        </div>
                        <div class="detailed-stat-row">
                            <span class="detailed-stat-label">Correct Answers</span>
                            <span id="stat-correct-answers" class="detailed-stat-value">0</span>
                        </div>
                        <div class="detailed-stat-row">
                            <span class="detailed-stat-label">Longest Streak</span>
                            <span id="stat-longest-streak" class="detailed-stat-value">0 days</span>
                        </div>
                        <div class="detailed-stat-row">
                            <span class="detailed-stat-label">Total XP Earned</span>
                            <span id="stat-total-xp" class="detailed-stat-value">0 XP</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visual Test Builder Section -->
        <div id="test-builder-section" class="section hidden">
            <div class="library-header">
                <h1>Test Builder</h1>
                <div style="display: flex; gap: var(--space-12);">
                    <button id="test-builder-preview-btn" class="btn btn--outline">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        Preview
                    </button>
                    <button id="test-builder-export-btn" class="btn btn--primary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Export JSON
                    </button>
                    <button id="close-test-builder-btn" class="btn btn--outline">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                        Back
                    </button>
                </div>
            </div>

            <!-- Test Builder Container -->
            <div class="test-builder-container">
                <!-- Left Sidebar: Test Metadata & Question List -->
                <div class="test-builder-sidebar">
                    <!-- Test Metadata -->
                    <div class="card" style="margin-bottom: var(--space-16);">
                        <div class="card__body">
                            <h3 style="margin-bottom: var(--space-16);">Test Details</h3>
                            <div class="form-group">
                                <label for="builder-test-title" class="form-label">Test Title *</label>
                                <input
                                    type="text"
                                    id="builder-test-title"
                                    class="form-control"
                                    placeholder="e.g., Biology Chapter 5 Quiz"
                                    required
                                >
                            </div>
                            <div class="form-group">
                                <label for="builder-test-course" class="form-label">Course</label>
                                <input
                                    type="text"
                                    id="builder-test-course"
                                    class="form-control"
                                    placeholder="e.g., Biology 101"
                                >
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="builder-test-topic" class="form-label">Topic</label>
                                <input
                                    type="text"
                                    id="builder-test-topic"
                                    class="form-control"
                                    placeholder="e.g., Cell Structure"
                                >
                            </div>
                        </div>
                    </div>

                    <!-- Question List -->
                    <div class="card">
                        <div class="card__body">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-16);">
                                <h3 style="margin: 0;">Questions</h3>
                                <span class="badge" id="builder-question-count">0</span>
                            </div>

                            <div id="builder-question-list" class="builder-question-list">
                                <div class="empty-state">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 48px; height: 48px; color: var(--color-text-secondary); margin-bottom: var(--space-12);">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="12" y1="8" x2="12" y2="12"></line>
                                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                    </svg>
                                    <p>No questions yet</p>
                                    <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Click "Add Question" to start building your test</p>
                                </div>
                            </div>

                            <button id="builder-add-question-btn" class="btn btn--primary btn--full-width" style="margin-top: var(--space-16);">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Add Question
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Question Editor -->
                <div class="test-builder-editor">
                    <div class="card">
                        <div class="card__body">
                            <div id="builder-editor-empty" class="empty-state">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 64px; height: 64px; color: var(--color-text-secondary); margin-bottom: var(--space-16);">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                                <h3 style="margin-bottom: var(--space-8);">Ready to Build</h3>
                                <p style="color: var(--color-text-secondary); max-width: 400px; text-align: center;">
                                    Add a question to get started, or import an existing test to edit
                                </p>
                            </div>

                            <div id="builder-editor-form" class="hidden">
                                <!-- Question Type Selector -->
                                <div class="form-group">
                                    <label for="builder-question-type" class="form-label">Question Type *</label>
                                    <select id="builder-question-type" class="form-control">
                                        <option value="mcq">Multiple Choice (Single Answer)</option>
                                        <option value="multi-select">Multiple Choice (Multi-Select)</option>
                                        <option value="matching">Matching</option>
                                        <option value="true-false">True/False</option>
                                        <option value="fill-blank">Fill in the Blank</option>
                                        <option value="ordering">Ordering/Sequencing</option>
                                    </select>
                                </div>

                                <!-- Question Text -->
                                <div class="form-group">
                                    <label for="builder-question-text" class="form-label">Question *</label>
                                    <textarea
                                        id="builder-question-text"
                                        class="form-control"
                                        rows="3"
                                        placeholder="Enter your question here..."
                                        required
                                    ></textarea>
                                </div>

                                <!-- MCQ / Multi-Select Options -->
                                <div id="builder-mcq-options-container">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-12);">
                                        <label class="form-label" style="margin-bottom: 0;">Answer Options *</label>
                                        <button id="builder-add-option-btn" class="btn btn--sm btn--outline">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                            </svg>
                                            Add Option
                                        </button>
                                    </div>
                                    <div id="builder-options-list"></div>
                                </div>

                                <!-- Matching Options -->
                                <div id="builder-matching-options-container" class="hidden">
                                    <div class="form-group">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-12);">
                                            <label class="form-label" style="margin-bottom: 0;">Matching Pairs *</label>
                                            <button id="builder-add-matching-pair-btn" class="btn btn--sm btn--outline">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                                </svg>
                                                Add Pair
                                            </button>
                                        </div>
                                        <div id="builder-matching-pairs-list"></div>
                                    </div>
                                </div>

                                <!-- True/False Options -->
                                <div id="builder-true-false-container" class="hidden">
                                    <div class="form-group">
                                        <label class="form-label">Correct Answer *</label>
                                        <div style="display: flex; gap: var(--space-16);">
                                            <label class="radio-label">
                                                <input type="radio" name="builder-tf-answer" value="true" checked>
                                                <span>True</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="builder-tf-answer" value="false">
                                                <span>False</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Fill-in-the-Blank Options -->
                                <div id="builder-fill-blank-container" class="hidden">
                                    <div class="form-group">
                                        <label for="builder-fill-accepted-answers" class="form-label">Accepted Answers * (one per line)</label>
                                        <textarea
                                            id="builder-fill-accepted-answers"
                                            class="form-control"
                                            rows="4"
                                            placeholder="Paris&#10;paris&#10;PARIS"
                                        ></textarea>
                                        <p class="hint-text">Add multiple accepted answers (one per line). First answer will be shown in review.</p>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="builder-fill-case-sensitive">
                                            <span>Case-sensitive matching</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Ordering Options -->
                                <div id="builder-ordering-container" class="hidden">
                                    <div class="form-group">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-12);">
                                            <label class="form-label" style="margin-bottom: 0;">Items in Correct Order *</label>
                                            <button id="builder-add-ordering-item-btn" class="btn btn--sm btn--outline">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                                </svg>
                                                Add Item
                                            </button>
                                        </div>
                                        <div id="builder-ordering-items-list"></div>
                                        <p class="hint-text">Add items in the correct order. They will be shuffled when the test is taken.</p>
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div style="display: flex; gap: var(--space-12); margin-top: var(--space-24); padding-top: var(--space-24); border-top: 1.5px solid var(--color-border);">
                                    <button id="builder-save-question-btn" class="btn btn--primary">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        Save Question
                                    </button>
                                    <button id="builder-cancel-question-btn" class="btn btn--outline">Cancel</button>
                                    <button id="builder-delete-question-btn" class="btn btn--outline hidden" style="margin-left: auto; color: var(--color-error); border-color: var(--color-error);">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polyline points="3 6 5 6 21 6"></polyline>
                                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                        </svg>
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="button-group" style="margin-top: var(--space-12);">
                        <button id="open-notes-btn" class="btn btn--secondary">üìù Notes</button>
                        <button id="open-whiteboard-btn" class="btn btn--secondary">üé® Whiteboard</button>
                    </div>
                    <div class="button-group" style="margin-top: var(--space-12);">
                        <button id="open-flashcards-btn" class="btn btn--secondary">üÉè Flashcards</button>
                        <button id="open-planner-btn" class="btn btn--secondary">üìÖ Study Planner</button>
                    </div>
                    <div class="button-group" style="margin-top: var(--space-12);">
                        <button id="open-habits-btn" class="btn btn--secondary">‚úÖ Habit Tracker</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Library Section -->
        <div id="test-library-section" class="section hidden">
            <div class="library-header">
                <h1>My Test Library</h1>
                <button id="close-library-btn" class="btn btn--outline">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Back
                </button>
            </div>

            <!-- Sync Status Banner -->
            <div id="library-sync-status" class="sync-status-banner hidden">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                <span id="library-sync-message">Tests are saved locally only. Sign in to sync across devices.</span>
            </div>

            <div class="library-controls">
                <input
                    type="text"
                    id="library-search"
                    class="form-control library-search"
                    placeholder="Search tests..."
                    aria-label="Search tests"
                >
                <div class="library-filters">
                    <select id="library-course-filter" class="form-control" aria-label="Filter by course">
                        <option value="">All Courses</option>
                    </select>
                    <select id="library-topic-filter" class="form-control" aria-label="Filter by topic">
                        <option value="">All Topics</option>
                    </select>
                </div>
            </div>

            <div id="test-library-grid" class="test-library-grid">
                <!-- Test cards will be inserted here -->
            </div>
        </div>

        <!-- Pomodoro Timer Section -->
        <div id="pomodoro-section" class="section hidden">
            <div class="library-header">
                <h1>Focus Timer</h1>
                <button id="close-pomodoro-btn" class="btn btn--outline">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Back
                </button>
            </div>

            <div class="pomodoro-container">
                <!-- Timer Display -->
                <div class="pomodoro-timer-card">
                    <div class="pomodoro-mode-indicator">
                        <span id="pomodoro-mode-text">Work Session</span>
                        <span id="pomodoro-session-count">Session 1 of 4</span>
                    </div>

                    <!-- Circular Timer -->
                    <div class="pomodoro-timer-circle">
                        <svg class="pomodoro-progress-ring" viewBox="0 0 280 280" width="100%" height="100%">
                            <circle
                                class="pomodoro-progress-ring-bg"
                                stroke="var(--color-border)"
                                stroke-width="12"
                                fill="transparent"
                                r="130"
                                cx="140"
                                cy="140"
                            />
                            <circle
                                id="pomodoro-progress-ring-fill"
                                class="pomodoro-progress-ring-fill"
                                stroke="var(--color-primary)"
                                stroke-width="12"
                                fill="transparent"
                                r="130"
                                cx="140"
                                cy="140"
                                stroke-dasharray="816.814 816.814"
                                stroke-dashoffset="0"
                                transform="rotate(-90 140 140)"
                            />
                        </svg>
                        <div class="pomodoro-timer-text">
                            <div id="pomodoro-time-display" class="pomodoro-time-display">25:00</div>
                            <div id="pomodoro-current-task" class="pomodoro-current-task">No task selected</div>
                        </div>
                    </div>

                    <!-- Timer Controls -->
                    <div class="pomodoro-controls">
                        <button id="pomodoro-start-btn" class="btn btn--primary btn--large">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                            Start
                        </button>
                        <button id="pomodoro-pause-btn" class="btn btn--outline btn--large hidden">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
                            </svg>
                            Pause
                        </button>
                        <button id="pomodoro-reset-btn" class="btn btn--outline">Reset</button>
                        <button id="pomodoro-skip-btn" class="btn btn--outline">Skip</button>
                        <button id="pomodoro-fullscreen-btn" class="btn btn--outline" title="Fullscreen (F)">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Sidebar with Tasks and Settings -->
                <div class="pomodoro-sidebar">
                    <!-- Quick Tasks -->
                    <div class="pomodoro-panel">
                        <h3>Today's Tasks</h3>
                        <div id="pomodoro-task-list" class="pomodoro-task-list">
                            <!-- Tasks will be inserted here -->
                        </div>
                        <button id="pomodoro-add-task-btn" class="btn btn--outline btn--sm" style="width: 100%;">+ Add Task</button>
                    </div>

                    <!-- Quick Stats -->
                    <div class="pomodoro-panel">
                        <h3>Today's Progress</h3>
                        <div class="pomodoro-stats">
                            <div class="pomodoro-stat-item">
                                <span class="pomodoro-stat-value" id="pomodoro-today-sessions">0</span>
                                <span class="pomodoro-stat-label">Sessions</span>
                            </div>
                            <div class="pomodoro-stat-item">
                                <span class="pomodoro-stat-value" id="pomodoro-today-time">0m</span>
                                <span class="pomodoro-stat-label">Focus Time</span>
                            </div>
                        </div>
                        <button id="pomodoro-view-analytics-btn" class="btn btn--outline btn--sm" style="width: 100%; margin-top: var(--space-12);">
                            View Analytics
                        </button>
                    </div>

                    <!-- Settings -->
                    <div class="pomodoro-panel">
                        <h3>Settings</h3>

                        <!-- Templates -->
                        <div class="form-group">
                            <label class="form-label">Focus Templates</label>
                            <div class="template-grid">
                                <button class="template-btn" onclick="pomodoroTimer.applyTemplate('quick')">
                                    <span class="template-icon">‚ö°</span>
                                    <span class="template-name">Quick Study</span>
                                    <span class="template-desc">25/5 min</span>
                                </button>
                                <button class="template-btn" onclick="pomodoroTimer.applyTemplate('deep')">
                                    <span class="template-icon">üéØ</span>
                                    <span class="template-name">Deep Work</span>
                                    <span class="template-desc">50/10 min</span>
                                </button>
                                <button class="template-btn" onclick="pomodoroTimer.applyTemplate('exam')">
                                    <span class="template-icon">üìö</span>
                                    <span class="template-name">Exam Prep</span>
                                    <span class="template-desc">45/15 min</span>
                                </button>
                                <button class="template-btn" onclick="pomodoroTimer.applyTemplate('light')">
                                    <span class="template-icon">‚òï</span>
                                    <span class="template-name">Light Review</span>
                                    <span class="template-desc">15/5 min</span>
                                </button>
                            </div>
                        </div>

                        <div class="form-divider"></div>

                        <div class="form-group">
                            <label class="form-label">Work Duration (min)</label>
                            <input type="number" id="pomodoro-work-duration" class="form-control" value="25" min="1" max="60">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Break Duration (min)</label>
                            <input type="number" id="pomodoro-break-duration" class="form-control" value="5" min="1" max="30">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Long Break (min)</label>
                            <input type="number" id="pomodoro-long-break-duration" class="form-control" value="15" min="1" max="60">
                        </div>
                        <div class="form-group">
                            <label class="form-checkbox">
                                <input type="checkbox" id="pomodoro-auto-start-breaks" checked>
                                <span>Auto-start breaks</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-checkbox">
                                <input type="checkbox" id="pomodoro-auto-start-pomodoros">
                                <span>Auto-start work sessions</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-checkbox">
                                <input type="checkbox" id="pomodoro-notifications" checked>
                                <span>Enable notifications</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-checkbox">
                                <input type="checkbox" id="pomodoro-sound-enabled" checked>
                                <span>Enable completion sounds</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-checkbox">
                                <input type="checkbox" id="pomodoro-ticking-enabled">
                                <span>Enable ticking sound</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Sound Volume</label>
                            <input type="range" id="pomodoro-sound-volume" class="form-range" min="0" max="100" value="50">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pomodoro Add Task Modal -->
        <div id="pomodoro-task-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add Study Task</h3>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Task Name</label>
                        <input type="text" id="pomodoro-task-name" class="form-control" placeholder="e.g., Study for CS101 Midterm">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Estimated Pomodoros</label>
                        <input type="number" id="pomodoro-task-estimate" class="form-control" value="4" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Course (optional)</label>
                        <input type="text" id="pomodoro-task-course" class="form-control" placeholder="e.g., CS101">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Priority</label>
                        <div class="priority-selector">
                            <label class="priority-option">
                                <input type="radio" name="task-priority" value="high">
                                <span class="priority-badge priority-high">üî¥ High</span>
                            </label>
                            <label class="priority-option">
                                <input type="radio" name="task-priority" value="medium" checked>
                                <span class="priority-badge priority-medium">üü° Medium</span>
                            </label>
                            <label class="priority-option">
                                <input type="radio" name="task-priority" value="low">
                                <span class="priority-badge priority-low">üü¢ Low</span>
                            </label>
                        </div>
                    </div>
                    <div class="button-group">
                        <button id="pomodoro-save-task-btn" class="btn btn--primary">Add Task</button>
                        <button id="pomodoro-cancel-task-btn" class="btn btn--outline">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div id="notes-section" class="section hidden">
            <div class="library-header">
                <h1>üìù My Notes</h1>
                <div class="library-header-actions">
                    <button id="create-note-btn" class="btn btn--primary">+ New Note</button>
                    <button id="close-notes-btn" class="btn btn--outline">‚Üê Back</button>
                </div>
            </div>

            <!-- Notes Filter -->
            <div class="library-filters">
                <input type="text" id="notes-search" class="form-control" placeholder="üîç Search notes...">
                <select id="notes-course-filter" class="form-control">
                    <option value="">All Courses</option>
                </select>
            </div>

            <!-- Notes Grid -->
            <div id="notes-grid" class="notes-grid">
                <!-- Notes will be inserted here -->
            </div>

            <!-- Empty State -->
            <div id="notes-empty-state" class="empty-state hidden">
                <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                <h3>No Notes Yet</h3>
                <p>Create your first note to get started!</p>
                <button class="btn btn--primary" onclick="document.getElementById('create-note-btn').click()">Create Note</button>
            </div>
        </div>

        <!-- Note Editor Modal -->
        <div id="note-editor-modal" class="modal hidden">
            <div class="modal-content modal-content--large">
                <div class="modal-header">
                    <h3 id="note-editor-title">New Note</h3>
                    <button id="close-note-editor-btn" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="note-editor-form">
                        <div class="form-group">
                            <label for="note-title-input" class="form-label">Title *</label>
                            <input type="text" id="note-title-input" class="form-control" placeholder="Note title" required>
                        </div>

                        <div class="form-group">
                            <label for="note-course-input" class="form-label">Course</label>
                            <input type="text" id="note-course-input" class="form-control" placeholder="e.g., Biology 101, Computer Science">
                        </div>

                        <div class="form-group">
                            <label for="note-tags-input" class="form-label">Tags (comma-separated)</label>
                            <input type="text" id="note-tags-input" class="form-control" placeholder="e.g., important, chapter-5, exam">
                        </div>

                        <div class="form-group">
                            <label for="note-content-input" class="form-label">Content *</label>
                            <textarea id="note-content-input" class="form-control" rows="12" placeholder="Write your notes here..." required></textarea>
                        </div>

                        <div class="button-group">
                            <button id="save-note-btn" class="btn btn--primary">Save Note</button>
                            <button id="cancel-note-btn" class="btn btn--outline">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Whiteboard Section -->
        <div id="whiteboard-section" class="section hidden">
            <div class="library-header">
                <h1>üé® Whiteboard</h1>
                <div class="library-header-actions">
                    <button id="save-whiteboard-btn" class="btn btn--primary">üíæ Save</button>
                    <button id="clear-whiteboard-btn" class="btn btn--outline">üóëÔ∏è Clear</button>
                    <button id="close-whiteboard-btn" class="btn btn--outline">‚Üê Back</button>
                </div>
            </div>

            <!-- Whiteboard Controls -->
            <div class="whiteboard-controls">
                <div class="whiteboard-tools">
                    <button class="tool-btn active" data-tool="pen" title="Pen">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
                            <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
                            <path d="M2 2l7.586 7.586"></path>
                            <circle cx="11" cy="11" r="2"></circle>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="eraser" title="Eraser">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 20H7L3 16c-1-1-1-2.5 0-3.5L10 5.5c1-1 2.5-1 3.5 0l7 7c1 1 1 2.5 0 3.5L16 20"></path>
                            <path d="M7 20H3.5"></path>
                        </svg>
                    </button>
                </div>

                <div class="whiteboard-color-picker">
                    <label>Color:</label>
                    <button class="color-btn active" data-color="#000000" style="background: #000000"></button>
                    <button class="color-btn" data-color="#FF0000" style="background: #FF0000"></button>
                    <button class="color-btn" data-color="#00FF00" style="background: #00FF00"></button>
                    <button class="color-btn" data-color="#0000FF" style="background: #0000FF"></button>
                    <button class="color-btn" data-color="#FFFF00" style="background: #FFFF00"></button>
                    <button class="color-btn" data-color="#FF00FF" style="background: #FF00FF"></button>
                    <button class="color-btn" data-color="#00FFFF" style="background: #00FFFF"></button>
                </div>

                <div class="whiteboard-size-control">
                    <label>Size:</label>
                    <input type="range" id="brush-size" min="1" max="20" value="3">
                    <span id="brush-size-label">3px</span>
                </div>

                <button id="download-whiteboard-btn" class="btn btn--sm btn--outline">üì• Download PNG</button>
            </div>

            <!-- Canvas -->
            <div class="whiteboard-canvas-container">
                <canvas id="whiteboard-canvas"></canvas>
            </div>
        </div>

        <!-- Pomodoro Analytics Modal -->
        <div id="pomodoro-analytics-modal" class="modal hidden">
            <div class="modal-content modal-content--large">
                <div class="modal-header">
                    <h3>Focus Analytics</h3>
                    <button id="close-analytics-modal-btn" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="analytics-summary">
                        <div class="analytics-card">
                            <h4>This Week</h4>
                            <div class="analytics-stat">
                                <span class="analytics-stat-value" id="analytics-week-sessions">0</span>
                                <span class="analytics-stat-label">Sessions</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="analytics-stat-value" id="analytics-week-time">0h 0m</span>
                                <span class="analytics-stat-label">Focus Time</span>
                            </div>
                        </div>
                        <div class="analytics-card">
                            <h4>This Month</h4>
                            <div class="analytics-stat">
                                <span class="analytics-stat-value" id="analytics-month-sessions">0</span>
                                <span class="analytics-stat-label">Sessions</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="analytics-stat-value" id="analytics-month-time">0h 0m</span>
                                <span class="analytics-stat-label">Focus Time</span>
                            </div>
                        </div>
                        <div class="analytics-card">
                            <h4>All Time</h4>
                            <div class="analytics-stat">
                                <span class="analytics-stat-value" id="analytics-total-sessions">0</span>
                                <span class="analytics-stat-label">Sessions</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="analytics-stat-value" id="analytics-total-time">0h 0m</span>
                                <span class="analytics-stat-label">Focus Time</span>
                            </div>
                        </div>
                    </div>

                    <div class="analytics-section">
                        <h4>Recent Sessions</h4>
                        <div id="analytics-recent-sessions" class="analytics-session-list">
                            <!-- Recent sessions will be inserted here -->
                        </div>
                    </div>

                    <div class="analytics-section">
                        <h4>Task Breakdown</h4>
                        <div id="analytics-task-breakdown" class="analytics-task-list">
                            <!-- Task breakdown will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Flashcards Section -->
        <div id="flashcards-section" class="section hidden">
            <div class="section-header">
                <h1>Flashcards</h1>
                <button id="close-flashcards-btn" class="btn btn--outline">‚Üê Back</button>
            </div>

            <!-- Decks Grid View -->
            <div class="decks-view">
                <div class="decks-header">
                    <input
                        type="text"
                        id="deck-search"
                        class="form-control"
                        placeholder="üîç Search decks..."
                        aria-label="Search decks"
                    >
                    <button id="create-deck-btn" class="btn btn--primary">+ Create Deck</button>
                </div>

                <div id="decks-grid" class="decks-grid">
                    <!-- Deck cards will be inserted here -->
                </div>

                <div id="decks-empty-state" class="empty-state hidden">
                    <p>No flashcard decks yet.</p>
                    <p>Create your first deck to start studying with spaced repetition!</p>
                </div>
            </div>

            <!-- Card Manager View -->
            <div id="card-manager-view" class="card-manager-view hidden">
                <div class="card-manager-header">
                    <button id="back-to-decks-btn" class="btn btn--outline">‚Üê Back to Decks</button>
                    <h2 id="current-deck-title">Deck Name</h2>
                    <div class="card-manager-actions">
                        <button id="add-card-btn" class="btn btn--secondary">+ Add Card</button>
                        <button id="start-study-btn" class="btn btn--primary">Study Now</button>
                    </div>
                </div>

                <div id="cards-list-container" class="cards-list-container">
                    <!-- Cards will be inserted here -->
                </div>
            </div>

            <!-- Study Session View -->
            <div id="study-session-view" class="study-session-view hidden">
                <div class="study-header">
                    <button id="exit-study-btn" class="btn btn--outline">‚Üê Exit Study</button>
                    <div class="study-progress-info">
                        <progress id="study-progress" value="0" max="100"></progress>
                        <span id="study-progress-text">Card 1 of 10</span>
                    </div>
                </div>

                <div class="flashcard-container">
                    <div id="flashcard" class="flashcard">
                        <div id="flashcard-inner" class="flashcard-inner">
                            <div class="flashcard-front">
                                <div class="flashcard-label">Question</div>
                                <div id="card-front" class="flashcard-text"></div>
                            </div>
                            <div class="flashcard-back">
                                <div class="flashcard-label">Answer</div>
                                <div id="card-back" class="flashcard-text"></div>
                            </div>
                        </div>
                    </div>

                    <div id="card-hint" class="card-hint hidden"></div>

                    <div class="flashcard-controls">
                        <button id="show-hint-btn" class="btn btn--outline">üí° Show Hint</button>
                        <button id="flip-card-btn" class="btn btn--primary">Flip Card</button>
                    </div>

                    <div id="quality-buttons" class="quality-buttons hidden">
                        <button id="again-btn" class="quality-btn quality-again">
                            <span class="quality-label">Again</span>
                            <span class="quality-desc">&lt; 1 day</span>
                        </button>
                        <button id="hard-btn" class="quality-btn quality-hard">
                            <span class="quality-label">Hard</span>
                            <span class="quality-desc">~3 days</span>
                        </button>
                        <button id="good-btn" class="quality-btn quality-good">
                            <span class="quality-label">Good</span>
                            <span class="quality-desc">~7 days</span>
                        </button>
                        <button id="easy-btn" class="quality-btn quality-easy">
                            <span class="quality-label">Easy</span>
                            <span class="quality-desc">~14 days</span>
                        </button>
                    </div>
                </div>

                <div id="session-stats" class="session-stats hidden">
                    <!-- Session summary will be shown here -->
                </div>
            </div>
        </div>

        <!-- Study Planner Section -->
        <div id="planner-section" class="section hidden">
            <div class="planner-layout">
                <div class="planner-main">
                    <div class="planner-header">
                        <h1>Study Planner</h1>
                        <div class="planner-controls">
                            <div class="view-toggle">
                                <button id="view-toggle-week" class="view-toggle-btn active">Week</button>
                                <button id="view-toggle-month" class="view-toggle-btn">Month</button>
                            </div>
                            <div class="period-navigation">
                                <button id="prev-period-btn" class="btn btn--sm">‚Üê</button>
                                <span id="current-period-label">January 2025</span>
                                <button id="next-period-btn" class="btn btn--sm">‚Üí</button>
                            </div>
                            <button id="today-btn" class="btn btn--sm btn--primary">Today</button>
                            <button id="close-planner-btn" class="btn btn--outline">‚Üê Back</button>
                        </div>
                    </div>

                    <!-- Week View -->
                    <div id="week-view" class="calendar-view">
                        <div id="week-grid" class="week-grid">
                            <!-- Week grid will be rendered here -->
                        </div>
                    </div>

                    <!-- Month View -->
                    <div id="month-view" class="calendar-view hidden">
                        <div id="month-grid" class="month-grid-container">
                            <!-- Month grid will be rendered here -->
                        </div>
                    </div>
                </div>

                <div class="planner-sidebar">
                    <h3>Upcoming Events</h3>
                    <div id="upcoming-events-list" class="upcoming-events-list">
                        <!-- Upcoming events will be listed here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Habit Tracker Section -->
        <div id="habits-section" class="section hidden">
            <div class="section-header">
                <h1>Habit Tracker</h1>
                <button id="close-habits-btn" class="btn btn--outline">‚Üê Back</button>
            </div>

            <!-- Stats Overview -->
            <div class="habits-stats-overview">
                <div class="habit-overview-stat">
                    <span class="habit-overview-value" id="total-habits">0</span>
                    <span class="habit-overview-label">Total Habits</span>
                </div>
                <div class="habit-overview-stat">
                    <span class="habit-overview-value" id="active-streaks">0</span>
                    <span class="habit-overview-label">Active Streaks</span>
                </div>
                <div class="habit-overview-stat">
                    <span class="habit-overview-value" id="completion-rate">0%</span>
                    <span class="habit-overview-label">Avg Rate</span>
                </div>
                <div class="habit-overview-stat">
                    <span class="habit-overview-value" id="longest-streak">0</span>
                    <span class="habit-overview-label">Best Streak</span>
                </div>
            </div>

            <div class="habits-controls">
                <button id="create-habit-btn" class="btn btn--primary">+ Create Habit</button>
            </div>

            <div id="habits-container" class="habits-container">
                <!-- Habit cards will be inserted here -->
            </div>

            <div id="habits-empty-state" class="empty-state hidden">
                <p>No habits tracked yet.</p>
                <p>Create your first habit to start building streaks!</p>
            </div>
        </div>

        <!-- Test Section -->
        <div id="test-section" class="section hidden">
            <div class="test-header">
                <div class="test-header-left">
                    <h2 id="test-title">Test Title</h2>
                    <div class="progress-indicator">
                        <span id="question-counter">Question 1 of 10</span>
                        <span id="mode-indicator" class="mode-badge mode-badge--exam hidden">Exam Mode</span>
                        <span id="review-indicator" class="review-badge hidden">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 14px; height: 14px;">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Review Session
                        </span>
                    </div>
                </div>
                <div class="timer-container hidden" aria-live="polite">
                    <span class="timer-label">Time Remaining:</span>
                    <span id="timer-display" class="timer-display">30:00</span>
                </div>
            </div>

            <div class="test-content-grid">
                <!-- Question Overview Panel -->
                <aside class="question-overview-panel" aria-label="Question navigation">
                    <div id="question-overview"></div>
                </aside>

                <!-- Main Question Area -->
                <main class="question-main">
                    <div class="card">
                        <div class="card__body">
                            <div id="question-container" role="main" aria-live="polite">
                                <!-- Question content will be inserted here -->
                            </div>

                            <!-- Practice Mode Feedback -->
                            <div id="practice-feedback" class="practice-feedback hidden" role="alert" aria-live="assertive">
                                <div class="feedback-icon"></div>
                                <div class="feedback-content">
                                    <div class="feedback-title"></div>
                                    <div class="feedback-message"></div>
                                </div>
                            </div>

                            <div class="navigation-buttons">
                                <button
                                    id="prev-btn"
                                    class="btn btn--outline"
                                    disabled
                                    aria-label="Previous question"
                                >
                                    Previous
                                </button>
                                <div class="nav-buttons-right">
                                    <button
                                        id="next-btn"
                                        class="btn btn--primary"
                                        aria-label="Next question"
                                    >
                                        Next
                                    </button>
                                    <button
                                        id="submit-btn"
                                        class="btn btn--primary hidden"
                                        aria-label="Submit test"
                                    >
                                        Submit Test
                                    </button>
                                </div>
                            </div>

                            <div class="keyboard-hints">
                                <p class="hint-text">
                                    <strong>Keyboard shortcuts:</strong>
                                    ‚Üê Previous | ‚Üí Next | Ctrl+Enter Submit
                                </p>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="section hidden">
            <div class="card">
                <div class="card__body">
                    <h2>Test Results</h2>
                    <div id="score-summary" class="score-summary">
                        <!-- Score will be inserted here -->
                    </div>

                    <div class="export-buttons">
                        <button id="save-test-btn" class="btn btn--primary" aria-label="Save test to library">
                            üíæ Save Test
                        </button>
                        <button id="export-pdf-btn" class="btn btn--secondary" aria-label="Export results as PDF">
                            üìÑ Export as PDF
                        </button>
                        <button id="export-csv-btn" class="btn btn--secondary" aria-label="Export results as CSV">
                            üìä Export as CSV
                        </button>
                    </div>

                    <h3>Review</h3>
                    <div id="results-review" role="region" aria-label="Answer review">
                        <!-- Detailed results will be inserted here -->
                    </div>

                    <div class="button-group">
                        <button id="review-wrong-btn" class="btn btn--secondary hidden">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 20px; height: 20px; margin-right: 8px;">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Review Wrong Answers
                        </button>
                        <button id="restart-btn" class="btn btn--primary">Load New Test</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Deck Editor Modal -->
    <div id="deck-editor-modal" class="modal hidden" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Deck</h3>
                <button id="close-deck-editor-btn" class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="deck-editor-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="deck-name-input" class="form-label">Deck Name *</label>
                        <input
                            type="text"
                            id="deck-name-input"
                            class="form-control"
                            placeholder="e.g., Spanish Vocabulary"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="deck-subject-input" class="form-label">Subject</label>
                        <input
                            type="text"
                            id="deck-subject-input"
                            class="form-control"
                            placeholder="e.g., Languages"
                        >
                    </div>
                    <div class="form-group">
                        <label for="deck-description-input" class="form-label">Description</label>
                        <textarea
                            id="deck-description-input"
                            class="form-control"
                            rows="3"
                            placeholder="Brief description of this deck..."
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button id="save-deck-btn" type="button" class="btn btn--primary">Save Deck</button>
                        <button id="cancel-deck-btn" type="button" class="btn btn--outline">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Card Editor Modal -->
    <div id="card-editor-modal" class="modal hidden" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Card</h3>
                <button id="close-card-editor-btn" class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="card-editor-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="card-front-input" class="form-label">Front (Question) *</label>
                        <textarea
                            id="card-front-input"
                            class="form-control"
                            rows="3"
                            placeholder="Enter the question or term..."
                            required
                        ></textarea>
                    </div>
                    <div class="form-group">
                        <label for="card-back-input" class="form-label">Back (Answer) *</label>
                        <textarea
                            id="card-back-input"
                            class="form-control"
                            rows="3"
                            placeholder="Enter the answer or definition..."
                            required
                        ></textarea>
                    </div>
                    <div class="form-group">
                        <label for="card-hint-input" class="form-label">Hint (Optional)</label>
                        <input
                            type="text"
                            id="card-hint-input"
                            class="form-control"
                            placeholder="A helpful hint..."
                        >
                    </div>
                    <div class="button-group">
                        <button id="save-card-btn" type="button" class="btn btn--primary">Save Card</button>
                        <button id="cancel-card-btn" type="button" class="btn btn--outline">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Event Editor Modal -->
    <div id="event-editor-modal" class="modal hidden" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Event</h3>
                <button id="close-event-editor-btn" class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="event-editor-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="event-title-input" class="form-label">Event Title *</label>
                        <input
                            type="text"
                            id="event-title-input"
                            class="form-control"
                            placeholder="e.g., Study Session, Exam"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="event-type-select" class="form-label">Event Type</label>
                        <select id="event-type-select" class="form-control">
                            <option value="study">üìö Study Session</option>
                            <option value="exam">üìù Exam</option>
                            <option value="deadline">‚è∞ Deadline</option>
                            <option value="class">üè´ Class</option>
                            <option value="review">üîç Review</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="event-date-input" class="form-label">Date *</label>
                        <input
                            type="date"
                            id="event-date-input"
                            class="form-control"
                            required
                        >
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="event-start-time-input" class="form-label">Start Time *</label>
                            <input
                                type="time"
                                id="event-start-time-input"
                                class="form-control"
                                required
                            >
                        </div>
                        <div class="form-group">
                            <label for="event-end-time-input" class="form-label">End Time *</label>
                            <input
                                type="time"
                                id="event-end-time-input"
                                class="form-control"
                                required
                            >
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="event-course-input" class="form-label">Course/Subject</label>
                        <input
                            type="text"
                            id="event-course-input"
                            class="form-control"
                            placeholder="e.g., CS101"
                        >
                    </div>
                    <div class="form-group">
                        <label for="event-notes-input" class="form-label">Notes</label>
                        <textarea
                            id="event-notes-input"
                            class="form-control"
                            rows="3"
                            placeholder="Additional details..."
                        ></textarea>
                    </div>
                    <div class="form-group">
                        <label for="event-color-input" class="form-label">Color</label>
                        <input
                            type="color"
                            id="event-color-input"
                            class="form-control"
                            value="#21808D"
                        >
                    </div>
                    <div class="button-group">
                        <button id="save-event-btn" type="button" class="btn btn--primary">Save Event</button>
                        <button id="delete-event-btn" type="button" class="btn btn--danger hidden">Delete Event</button>
                        <button id="cancel-event-btn" type="button" class="btn btn--outline">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Habit Editor Modal -->
    <div id="habit-editor-modal" class="modal hidden" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Habit</h3>
                <button id="close-habit-editor-btn" class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="habit-editor-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="habit-name-input" class="form-label">Habit Name *</label>
                        <input
                            type="text"
                            id="habit-name-input"
                            class="form-control"
                            placeholder="e.g., Review flashcards daily"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="habit-desc-input" class="form-label">Description</label>
                        <textarea
                            id="habit-desc-input"
                            class="form-control"
                            rows="2"
                            placeholder="Brief description..."
                        ></textarea>
                    </div>
                    <div class="form-group">
                        <label for="habit-category-select" class="form-label">Category</label>
                        <select id="habit-category-select" class="form-control">
                            <option value="study">üìö Study</option>
                            <option value="exercise">üí™ Exercise</option>
                            <option value="health">üè• Health</option>
                            <option value="mindfulness">üßò Mindfulness</option>
                            <option value="reading">üìñ Reading</option>
                            <option value="productivity">‚ö° Productivity</option>
                            <option value="other">‚≠ê Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="habit-goal-input" class="form-label">Goal Streak (days)</label>
                        <input
                            type="number"
                            id="habit-goal-input"
                            class="form-control"
                            min="1"
                            max="365"
                            value="30"
                        >
                    </div>
                    <div class="form-group">
                        <label for="habit-color-input" class="form-label">Color</label>
                        <input
                            type="color"
                            id="habit-color-input"
                            class="form-control"
                            value="#21808D"
                        >
                    </div>
                    <div class="button-group">
                        <button id="save-habit-btn" type="button" class="btn btn--primary">Save Habit</button>
                        <button id="cancel-habit-btn" type="button" class="btn btn--outline">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal hidden" role="dialog" aria-labelledby="confirm-modal-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirm-modal-title">Confirm Submission</h3>
            </div>
            <div class="modal-body">
                <p class="confirm-message">Are you sure you want to submit your test?</p>
                <div class="button-group">
                    <button id="confirm-submit-btn" class="btn btn--primary">Yes, Submit</button>
                    <button id="cancel-submit-btn" class="btn btn--outline">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Save Test Modal -->
    <div id="save-test-modal" class="modal hidden" role="dialog" aria-labelledby="save-test-modal-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="save-test-modal-title">Save Test to Library</h3>
            </div>
            <div class="modal-body">
                <p>Save this test to your library for easy access later.</p>
                <div class="form-group">
                    <label for="save-test-title" class="form-label">Test Title *</label>
                    <input
                        type="text"
                        id="save-test-title"
                        class="form-control"
                        placeholder="e.g., Midterm Practice"
                        required
                        aria-label="Test title"
                    >
                </div>
                <div class="form-group">
                    <label for="save-test-course" class="form-label">Course *</label>
                    <input
                        type="text"
                        id="save-test-course"
                        class="form-control"
                        placeholder="e.g., CS101, MATH201"
                        required
                        aria-label="Course name"
                    >
                </div>
                <div class="form-group">
                    <label for="save-test-topic" class="form-label">Topic (optional)</label>
                    <input
                        type="text"
                        id="save-test-topic"
                        class="form-control"
                        placeholder="e.g., Algorithms, Calculus"
                        aria-label="Topic"
                    >
                </div>
                <div class="button-group">
                    <button id="save-test-form-btn" class="btn btn--primary">üíæ Save</button>
                    <button id="cancel-save-btn" class="btn btn--outline">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Test Modal -->
    <div id="share-test-modal" class="modal hidden" role="dialog" aria-labelledby="share-test-modal-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="share-test-modal-title">Share Test with Classmates</h3>
            </div>
            <div class="modal-body">
                <p>Share this test with your classmates. They can use the code to access it.</p>
                <div id="share-code-display" class="share-code-display hidden">
                    <div class="share-code-label">Share Code:</div>
                    <div id="share-code-value" class="share-code-value"></div>
                    <button id="copy-share-code-btn" class="btn btn--outline btn--sm">üìã Copy Code</button>
                </div>
                <div class="button-group">
                    <button id="generate-share-code-btn" class="btn btn--primary">Generate Share Code</button>
                    <button id="publish-to-community-btn" class="btn btn--secondary">Publish to Community</button>
                    <button id="close-share-modal-btn" class="btn btn--outline">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Access Shared Test Modal -->
    <div id="access-shared-modal" class="modal hidden" role="dialog" aria-labelledby="access-shared-modal-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="access-shared-modal-title">Access Shared Test</h3>
            </div>
            <div class="modal-body">
                <p>Enter the share code you received from a classmate to access their test.</p>
                <div class="form-group">
                    <label for="shared-test-code" class="form-label">Share Code</label>
                    <input
                        type="text"
                        id="shared-test-code"
                        class="form-control"
                        placeholder="e.g., ABC123"
                        style="text-transform: uppercase;"
                        maxlength="6"
                        aria-label="Share code"
                    >
                </div>
                <div class="button-group">
                    <button id="load-shared-test-btn" class="btn btn--primary">Load Test</button>
                    <button id="close-access-shared-modal-btn" class="btn btn--outline">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Community Browser Modal -->
    <div id="community-browser-modal" class="modal hidden" role="dialog" aria-labelledby="community-browser-modal-title" aria-modal="true">
        <div class="modal-content modal-content--large">
            <div class="modal-header">
                <h3 id="community-browser-modal-title">Community Test Library</h3>
                <button id="close-community-modal-btn" class="close-btn" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="library-controls">
                    <input
                        type="text"
                        id="community-search"
                        class="form-control library-search"
                        placeholder="üîç Search community tests..."
                        aria-label="Search community tests"
                    >
                    <div class="library-filters">
                        <select id="community-course-filter" class="form-control" aria-label="Filter by course">
                            <option value="">All Courses</option>
                        </select>
                        <select id="community-topic-filter" class="form-control" aria-label="Filter by topic">
                            <option value="">All Topics</option>
                        </select>
                    </div>
                </div>
                <div id="community-grid" class="test-library-grid">
                    <!-- Community tests dynamically inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Test Insights Modal -->
    <div id="insights-modal" class="modal hidden" role="dialog" aria-labelledby="insights-modal-title" aria-modal="true">
        <div class="modal-content modal-content--large">
            <div class="modal-header">
                <h3 id="insights-modal-title">üìä Test Performance Insights</h3>
                <button id="close-insights-modal-btn" class="close-btn" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Overview Stats -->
                <div class="insights-overview">
                    <div class="insight-card">
                        <div class="insight-icon">üéØ</div>
                        <div class="insight-content">
                            <div class="insight-label">Average Score</div>
                            <div class="insight-value" id="insight-avg-score">--%</div>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">üìà</div>
                        <div class="insight-content">
                            <div class="insight-label">Total Tests Taken</div>
                            <div class="insight-value" id="insight-total-tests">--</div>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">üî•</div>
                        <div class="insight-content">
                            <div class="insight-label">Current Streak</div>
                            <div class="insight-value" id="insight-streak">-- days</div>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">‚≠ê</div>
                        <div class="insight-content">
                            <div class="insight-label">Best Score</div>
                            <div class="insight-value" id="insight-best-score">--%</div>
                        </div>
                    </div>
                </div>

                <!-- Performance Trend -->
                <div class="insights-section">
                    <h4>Performance Trend</h4>
                    <div id="insight-trend" class="insight-trend-display">
                        <!-- Trend visualization will be inserted here -->
                    </div>
                </div>

                <!-- Question Type Performance -->
                <div class="insights-section">
                    <h4>Performance by Question Type</h4>
                    <div id="insight-question-types" class="insight-stats-grid">
                        <!-- Question type stats will be inserted here -->
                    </div>
                </div>

                <!-- Course Performance -->
                <div class="insights-section">
                    <h4>Performance by Course</h4>
                    <div id="insight-courses" class="insight-courses-list">
                        <!-- Course performance will be inserted here -->
                    </div>
                </div>

                <!-- Time Analysis -->
                <div class="insights-section">
                    <h4>Time Analysis</h4>
                    <div id="insight-time-analysis" class="insight-stats-grid">
                        <!-- Time stats will be inserted here -->
                    </div>
                </div>

                <!-- Weak Areas & Recommendations -->
                <div class="insights-section">
                    <h4>Areas for Improvement</h4>
                    <div id="insight-weak-areas" class="insight-recommendations">
                        <!-- Recommendations will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Prompt Instructions Modal -->
    <div id="prompt-modal" class="modal hidden" role="dialog" aria-labelledby="prompt-modal-title" aria-modal="true">
        <div class="modal-content modal-content--large">
            <div class="modal-header">
                <h3 id="prompt-modal-title">AI Test Generation Prompt Builder</h3>
                <button id="close-modal" class="close-btn" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Customize your test generation prompt with advanced options:</p>

                <!-- Prompt Builder Form -->
                <div class="prompt-builder-form">
                    <div class="prompt-builder-grid">
                        <div class="form-group">
                            <label class="form-label">Subject/Topic *</label>
                            <input type="text" id="prompt-topic" class="form-control" placeholder="e.g., Biology, JavaScript, World History" value="">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Number of Questions</label>
                            <input type="number" id="prompt-count" class="form-control" value="10" min="1" max="100">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Difficulty Level</label>
                            <select id="prompt-difficulty" class="form-control">
                                <option value="easy">Easy - Introductory level</option>
                                <option value="medium" selected>Medium - Standard level</option>
                                <option value="hard">Hard - Advanced level</option>
                                <option value="expert">Expert - Professional/Midterm level</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Question Type Distribution</label>
                            <select id="prompt-distribution" class="form-control">
                                <option value="balanced" selected>Balanced Mix</option>
                                <option value="mcq-heavy">Mostly MCQ</option>
                                <option value="multiselect-heavy">Mostly Multi-Select</option>
                                <option value="matching-heavy">Mostly Matching</option>
                                <option value="mcq-only">MCQ Only</option>
                                <option value="no-matching">No Matching Questions</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Question Style</label>
                            <select id="prompt-style" class="form-control">
                                <option value="academic" selected>Academic/Formal</option>
                                <option value="conversational">Conversational/Friendly</option>
                                <option value="challenging">Challenging/Tricky</option>
                                <option value="practical">Practical/Real-world</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Additional Context (Optional)</label>
                            <input type="text" id="prompt-context" class="form-control" placeholder="e.g., Focus on Chapter 5, Include recent developments">
                        </div>
                    </div>

                    <!-- Advanced Options -->
                    <div class="prompt-advanced-options">
                        <h4>Advanced Options</h4>
                        <div class="prompt-checkboxes">
                            <label class="form-checkbox">
                                <input type="checkbox" id="prompt-shuffle" checked>
                                <span>Shuffle answer options</span>
                            </label>
                            <label class="form-checkbox">
                                <input type="checkbox" id="prompt-explanations">
                                <span>Include explanations (as comments)</span>
                            </label>
                            <label class="form-checkbox">
                                <input type="checkbox" id="prompt-distractors" checked>
                                <span>Use plausible incorrect options</span>
                            </label>
                            <label class="form-checkbox">
                                <input type="checkbox" id="prompt-creative">
                                <span>Creative matching questions (beyond definitions)</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Generated Prompt Display -->
                <div class="prompt-output-section">
                    <div class="prompt-output-header">
                        <h4>Generated Prompt</h4>
                        <button id="prompt-copy-btn" class="btn btn--outline btn--sm">Copy Prompt</button>
                    </div>
                    <div class="prompt-box" id="generated-prompt-display">
                        <code id="generated-prompt-text">Configure options above to generate your custom prompt</code>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="button-group" style="margin-top: var(--space-16);">
                    <button id="prompt-generate-btn" class="btn btn--primary">Generate Prompt</button>
                    <button id="prompt-reset-btn" class="btn btn--outline">Reset to Defaults</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ambient Soundscape Generator -->
    <div id="soundscape-player" class="soundscape-player" role="region" aria-label="Ambient soundscape generator">
        <div class="soundscape-header">
            <button id="soundscape-toggle-btn" class="soundscape-toggle-btn" aria-label="Toggle soundscape player">
                <svg class="soundscape-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"></path>
                </svg>
                <span class="soundscape-label">Soundscapes</span>
            </button>
        </div>

        <div id="soundscape-content" class="soundscape-content hidden">
            <div class="soundscape-body">
                <h4 class="soundscape-title">Ambient Soundscape Mixer</h4>
                <p class="soundscape-subtitle">Mix multiple sounds to create your perfect study environment</p>

                <!-- Sound Controls Grid -->
                <div class="soundscape-grid">
                    <!-- White Noise -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="whitenoise">
                                <span class="sound-name">üå´Ô∏è White Noise</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="whitenoise" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>

                    <!-- Rain -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="rain">
                                <span class="sound-name">üåßÔ∏è Rain</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="rain" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>

                    <!-- Thunder -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="thunder">
                                <span class="sound-name">‚ö° Thunder</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="thunder" min="0" max="100" value="30" disabled>
                        <span class="sound-volume-label">30%</span>
                    </div>

                    <!-- Ocean Waves -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="ocean">
                                <span class="sound-name">üåä Ocean Waves</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="ocean" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>

                    <!-- Forest -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="forest">
                                <span class="sound-name">üå≤ Forest</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="forest" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>

                    <!-- Fireplace -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="fireplace">
                                <span class="sound-name">üî• Fireplace</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="fireplace" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>

                    <!-- Coffee Shop -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="coffeeshop">
                                <span class="sound-name">‚òï Coffee Shop</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="coffeeshop" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>

                    <!-- Fan -->
                    <div class="sound-control">
                        <div class="sound-header">
                            <label class="sound-checkbox">
                                <input type="checkbox" class="sound-toggle" data-sound="fan">
                                <span class="sound-name">üí® Fan</span>
                            </label>
                        </div>
                        <input type="range" class="sound-volume" data-sound="fan" min="0" max="100" value="50" disabled>
                        <span class="sound-volume-label">50%</span>
                    </div>
                </div>

                <!-- Preset Controls -->
                <div class="soundscape-presets">
                    <h5>Presets</h5>
                    <div class="preset-buttons">
                        <button class="btn btn--sm btn--outline preset-btn" data-preset="focus">üéØ Deep Focus</button>
                        <button class="btn btn--sm btn--outline preset-btn" data-preset="relax">üòå Relax</button>
                        <button class="btn btn--sm btn--outline preset-btn" data-preset="rainy">üåßÔ∏è Rainy Day</button>
                        <button class="btn btn--sm btn--outline preset-btn" data-preset="nature">üåø Nature</button>
                    </div>
                </div>

                <!-- Timer Controls -->
                <div class="soundscape-timer">
                    <label class="sound-checkbox">
                        <input type="checkbox" id="soundscape-timer-toggle">
                        <span>Auto-stop after:</span>
                    </label>
                    <select id="soundscape-timer-duration" class="form-control form-control--sm" disabled>
                        <option value="15">15 minutes</option>
                        <option value="30">30 minutes</option>
                        <option value="45">45 minutes</option>
                        <option value="60">1 hour</option>
                        <option value="90">1.5 hours</option>
                        <option value="120">2 hours</option>
                    </select>
                </div>

                <!-- Master Controls -->
                <div class="soundscape-master-controls">
                    <button id="soundscape-play-all" class="btn btn--primary btn--sm">‚ñ∂Ô∏è Play</button>
                    <button id="soundscape-stop-all" class="btn btn--outline btn--sm">‚èπÔ∏è Stop All</button>
                    <div class="soundscape-master-volume">
                        <label>Master Volume:</label>
                        <input type="range" id="soundscape-master-volume" min="0" max="100" value="100">
                        <span id="soundscape-master-volume-label">100%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lofi Music Player -->
    <div id="music-player" class="music-player" role="region" aria-label="Lofi music player">
        <div class="music-player-header">
            <button id="music-toggle-btn" class="music-toggle-btn" aria-label="Toggle music player">
                <svg class="music-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18V5l12-2v13"></path>
                    <circle cx="6" cy="18" r="3"></circle>
                    <circle cx="18" cy="16" r="3"></circle>
                </svg>
                <span class="music-label">Lofi Beats</span>
            </button>
        </div>

        <div id="music-player-content" class="music-player-content hidden">
            <div class="music-player-body">
                <div class="music-channel-selector">
                    <label class="music-label-small">Choose your vibe:</label>
                    <select id="music-channel-select" class="music-channel-select" aria-label="Select lofi channel">
                        <option value="jfKfPfyJRdk">Lofi Girl - Beats to Relax/Study</option>
                        <option value="rUxyKA_-grg">Lofi Girl - Sleep/Chill</option>
                        <option value="lTRiuFIWV54">Lofi Girl - Jazz Hip Hop</option>
                        <option value="7NOSDKb0HlU">Chillhop - Relaxing Beats</option>
                    </select>
                </div>

                <div class="music-player-frame" id="music-player-frame">
                    <!-- YouTube iframe will be inserted here -->
                </div>

                <div class="music-controls">
                    <button id="music-play-btn" class="music-control-btn" aria-label="Play music">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </button>
                    <button id="music-pause-btn" class="music-control-btn hidden" aria-label="Pause music">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
                        </svg>
                    </button>
                    <div class="music-volume-control">
                        <svg class="volume-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                        </svg>
                        <input type="range" id="music-volume-slider" class="music-volume-slider"
                               min="0" max="100" value="30" aria-label="Volume control">
                        <span id="music-volume-label" class="music-volume-label">30%</span>
                    </div>
                </div>

                <div class="music-info">
                    <p class="music-info-text">Gentle background music to help you focus</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden" role="status" aria-live="polite">
        <div class="loading-spinner"></div>
        <p class="loading-message">Loading...</p>
    </div>

    <button id="show-prompt-btn" class="floating-help-btn" aria-label="Show AI generation prompt">?</button>

    <!-- PWA Install Prompt -->
    <div id="install-prompt" class="install-prompt hidden">
        <div class="install-prompt-content">
            <h3>Install Test Simulator</h3>
            <p>Install this app on your device for offline access and a native app experience!</p>
            <div class="button-group">
                <button id="install-btn" class="btn btn--primary">Install</button>
                <button id="dismiss-install-btn" class="btn btn--outline">Not Now</button>
            </div>
        </div>
    </div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>

    <!-- Firebase Service Layer -->
    <script src="firebase-service.js"></script>

    <!-- Gamification System -->
    <script src="gamification.js"></script>

    <script src="app.js"></script>

    <!-- Pomodoro Timer Module -->
    <script src="pomodoro.js"></script>

    <!-- Music Player Module -->
    <script src="music-player.js"></script>

    <!-- Soundscape Player Module -->
    <script src="soundscape-player.js"></script>

    <!-- Notes Module -->
    <script src="notes.js"></script>

    <!-- Whiteboard Module -->
    <script src="whiteboard.js"></script>

    <!-- Flashcards Module -->
    <script src="flashcards.js"></script>

    <!-- Study Planner Module -->
    <script src="study-planner.js"></script>

    <!-- Habit Tracker Module -->
    <script src="habit-tracker.js"></script>

    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }

        // Handle PWA install prompt
        let deferredPrompt;
        const installPrompt = document.getElementById('install-prompt');
        const installBtn = document.getElementById('install-btn');
        const dismissInstallBtn = document.getElementById('dismiss-install-btn');

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the default install prompt
            e.preventDefault();
            deferredPrompt = e;

            // Show custom install prompt (after 3 seconds)
            setTimeout(() => {
                if (localStorage.getItem('installPromptDismissed') !== 'true') {
                    installPrompt?.classList.remove('hidden');
                }
            }, 3000);
        });

        installBtn?.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User ${outcome} the install prompt`);
                deferredPrompt = null;
                installPrompt?.classList.add('hidden');
            }
        });

        dismissInstallBtn?.addEventListener('click', () => {
            installPrompt?.classList.add('hidden');
            localStorage.setItem('installPromptDismissed', 'true');
        });

        // Handle successful installation
        window.addEventListener('appinstalled', () => {
            console.log('PWA installed successfully');
            installPrompt?.classList.add('hidden');
        });
    </script>

    <!-- Achievement Toast Notifications -->
    <div id="achievement-toast-container" class="achievement-toast-container"></div>

</body>
</html>
